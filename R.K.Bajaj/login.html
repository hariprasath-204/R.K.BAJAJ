<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Login & Register</title>
  
  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- FontAwesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">

<style>
  body {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background: linear-gradient(to right, #ff4d4d, #b30000); /* red shades */
    font-family: "Segoe UI", sans-serif;
    color: #fff;
  }

  .card {
    width: 370px;
    border-radius: 15px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.5);
    background-color: #000; /* black card */
    color: #fff;
  }

  .form-title {
    font-weight: bold;
    color: #ff4d4d; /* red for titles */
  }

  .form-control {
    border-radius: 10px;
    border: 1px solid #ff4d4d;
    background-color: #000;
    color: #fff;
  }

  .form-control:focus {
    border-color: #fff;
    box-shadow: 0 0 5px #ff4d4d;
    background-color: #000;
    color: #fff;
  }

  .form-select {
    border-radius: 10px;
    border: 1px solid #ff4d4d;
    background-color: #000;
    color: #fff;
  }

  .form-select:focus {
    border-color: #fff;
    box-shadow: 0 0 5px #ff4d4d;
    background-color: #000;
    color: #fff;
  }

  .btn-primary {
    background-color: #ff4d4d;
    border-color: #ff4d4d;
    color: #fff;
  }

  .btn-primary:hover {
    background-color: #b30000;
    border-color: #b30000;
  }

  .btn-success {
    background-color: #ff4d4d;
    border-color: #ff4d4d;
    color: #fff;
  }

  .btn-success:hover {
    background-color: #b30000;
    border-color: #b30000;
  }

  .alert {
    background-color: #b30000;
    color: #fff;
    border: none;
  }

  .toggle-link {
    cursor: pointer;
    color: #ff4d4d;
  }

  .toggle-link:hover {
    text-decoration: underline;
    color: #fff;
  }

  ::placeholder {
    color: #aaa;
  }
</style>

</head>
<body>

  <div class="card p-4">
    <!-- Login Form -->
    <div id="loginForm">
      <h3 class="text-center form-title mb-3"><i class="fas fa-sign-in-alt me-2"></i>Login</h3>
      <form id="loginFormEl">
        <div class="mb-3">
          <label class="form-label">Email</label>
          <input id="loginEmail" type="email" class="form-control" required>
        </div>
        <div class="mb-3">
          <label class="form-label">Password</label>
          <input id="loginPassword" type="password" class="form-control" required>
        </div>
        <div id="loginError" class="alert alert-danger d-none"></div>
        <button type="submit" class="btn btn-primary w-100">Login</button>
      </form>
      <p class="mt-3 text-center">
        Don‚Äôt have an account? <span class="toggle-link" onclick="showRegister()">Register</span>
      </p>
    </div>

    <!-- Register Form -->
    <div id="registerForm" style="display:none;">
      <h3 class="text-center form-title mb-3"><i class="fas fa-user-plus me-2"></i>Register</h3>
      <form id="registerFormEl">
        <div class="row">
          <div class="col-md-6 mb-3">
            <label class="form-label">First name</label>
            <input id="firstName" type="text" class="form-control"  required>
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label">Last name</label>
            <input id="lastName" type="text" class="form-control"  required>
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label">Email id</label>
          <input id="registerEmail" type="email" class="form-control"  required>
        </div>
        <div class="mb-3">
          <label class="form-label">Phone number</label>
          <input id="phone" type="tel" class="form-control"  required>
        </div>
        <div class="mb-3">
          <label class="form-label">Password</label>
          <input id="registerPassword" type="password" class="form-control"  required>
        </div>
        <div class="mb-3">
          <label class="form-label">Gender</label>
          <select id="gender" class="form-select" required>
            <option value="">Select Gender</option>
            <option value="male">Male</option>
            <option value="female">Female</option>
            <option value="other">Other</option>
          </select>
        </div>
        <div id="registerError" class="alert alert-danger d-none"></div>
        <button type="submit" class="btn btn-success w-100">Register</button>
      </form>
      <p class="mt-3 text-center">
        Already have an account? <span class="toggle-link" onclick="showLogin()">Login</span>
      </p>
    </div>
  </div>

  <script>
  const API_URL = "http://localhost:3000/api"; // change port if needed

  // Allow only 10 digits for phone input
  const phoneInput = document.getElementById("phone");
  phoneInput.addEventListener("input", function() {
    // Remove non-digit characters
    this.value = this.value.replace(/\D/g, "");
    // Limit to 10 digits
    if (this.value.length > 10) {
      this.value = this.value.slice(0, 10);
    }
  });

  function showRegister() {
    document.getElementById("loginForm").style.display = "none";
    document.getElementById("registerForm").style.display = "block";
  }
  function showLogin() {
    document.getElementById("registerForm").style.display = "none";
    document.getElementById("loginForm").style.display = "block";
  }

  // Register
  document.getElementById("registerFormEl").addEventListener("submit", async (e) => {
    e.preventDefault();
    const data = {
      first_name: document.getElementById("firstName").value.trim(),
      last_name: document.getElementById("lastName").value.trim(),
      email: document.getElementById("registerEmail").value.trim(),
      phone: document.getElementById("phone").value.trim(),
      password: document.getElementById("registerPassword").value,
      gender: document.getElementById("gender").value
    };

    // Extra validation for phone number length
    if (data.phone.length !== 10) {
      document.getElementById("registerError").textContent = "Phone number must be 10 digits";
      document.getElementById("registerError").classList.remove("d-none");
      return;
    }

    try {
      const res = await fetch(`${API_URL}/register`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });
      const result = await res.json();

      if (!res.ok) {
        document.getElementById("registerError").textContent = result.error;
        document.getElementById("registerError").classList.remove("d-none");
        return;
      }

      alert("‚úÖ Registration successful! Please login.");
      showLogin();
    } catch (err) {
      alert("‚ö†Ô∏è Server error");
    }
  });

  // Login
  document.getElementById("loginFormEl").addEventListener("submit", async (e) => {
    e.preventDefault();
    const data = {
      email: document.getElementById("loginEmail").value.trim(),
      password: document.getElementById("loginPassword").value
    };

    try {
      const res = await fetch(`${API_URL}/login`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });
      const result = await res.json();

      if (!res.ok) {
        document.getElementById("loginError").textContent = result.error;
        document.getElementById("loginError").classList.remove("d-none");
        return;
      }

      // Save token
      localStorage.setItem("token", result.token);

      alert("üéâ Login successful!");
      window.location.href = "index.html"; 

    } catch (err) {
      alert("‚ö†Ô∏è Server error");
    }
  });
</script>
</body>
</html>
